import{_ as e}from"./u-tabs.OeK_Loi0.js";import{m as a,p as s,q as t,c as l,w as o,n,i as u,o as c,a as p,b as i,d,F as r,k as m,f as _,t as f,e as y,l as h}from"./index-BR_epvkd.js";import{r as b}from"./uni-app.es.Cu0rwAi-.js";import{M as T,_ as C}from"./mescroll-mixins.nOOeBu6g.js";import{l as x}from"./myCoupon.CCuhA_Za.js";import{C as v}from"./CouponType.DMOMRrRc.js";import{_ as g}from"./_plugin-vue_export-helper.BCo6x5W8.js";const k=[{name:"未使用",value:"isUnused"},{name:"已使用",value:"isUse"},{name:"已过期",value:"isExpire"}];const U=g({mixins:[T],data:()=>({CouponTypeEnum:v,tabs:k,curTab:0,list:a(),upOption:{auto:!0,page:{size:15},noMoreSize:4,empty:{tip:"亲，暂无相关优惠券"}}}),onLoad(e){},methods:{upCallback(e){const a=this;a.getCouponList(e.num).then((e=>{const s=e.data.length,t=e.total;a.mescroll.endBySize(s,t)})).catch((()=>a.mescroll.endErr()))},getCouponList(e=1){const a=this;return new Promise(((t,l)=>{x({dataType:a.getTabValue(),page:e},{load:!1}).then((l=>{const o=l.data.list;a.list.data=s(o,a.list,e),t(o)}))}))},getTabValue(){return this.tabs[this.curTab].value},onChangeTab(e){this.curTab=e,this.onRefreshList()},onRefreshList(){this.list=a(),setTimeout((()=>{this.mescroll.resetUpScroll()}),120)},handleDescribe(e){this.list.data[e].expand=!this.list.data[e].expand}}},[["render",function(a,s,T,x,v,g){const k=b(t("u-tabs"),e),U=h,L=u,E=b(t("mescroll-body"),C);return c(),l(L,{class:"container",style:n(a.appThemeStyle)},{default:o((()=>[p(E,{ref:"mescrollRef",sticky:!0,onInit:a.mescrollInit,down:{use:!1},up:v.upOption,onUp:g.upCallback},{default:o((()=>[p(k,{list:v.tabs,"is-scroll":!1,modelValue:v.curTab,"onUpdate:modelValue":s[0]||(s[0]=e=>v.curTab=e),"active-color":a.appTheme.mainBg,duration:.2,onChange:g.onChangeTab},null,8,["list","modelValue","active-color","onChange"]),p(L,{class:"coupon-list"},{default:o((()=>[(c(!0),i(r,null,d(v.list.data,((e,a)=>(c(),l(L,{class:"coupon-item",key:a},{default:o((()=>[p(L,{class:m(["item-wrapper",[e.state.value?"":"disable"]])},{default:o((()=>[p(L,{class:"coupon-tag"},{default:o((()=>[p(U,null,{default:o((()=>[_(f(v.CouponTypeEnum[e.coupon_type].name),1)])),_:2},1024)])),_:2},1024),p(L,{class:"coupon-left"},{default:o((()=>[p(L,{class:"coupon-reduce"},{default:o((()=>[e.coupon_type==v.CouponTypeEnum.FULL_DISCOUNT.value?(c(),i(r,{key:0},[p(L,{class:"coupon-reduce-unit"},{default:o((()=>[p(U,null,{default:o((()=>[_("￥")])),_:1})])),_:1}),p(L,{class:"coupon-reduce-amount"},{default:o((()=>[p(U,{class:"value"},{default:o((()=>[_(f(e.reduce_price),1)])),_:2},1024)])),_:2},1024)],64)):y("",!0),e.coupon_type==v.CouponTypeEnum.DISCOUNT.value?(c(),l(L,{key:1,class:"coupon-reduce-amount"},{default:o((()=>[p(U,{class:"value"},{default:o((()=>[_(f(e.discount)+"折",1)])),_:2},1024)])),_:2},1024)):y("",!0)])),_:2},1024),p(U,{class:"coupon-hint"},{default:o((()=>[_("满"+f(e.min_price)+"元可用",1)])),_:2},1024)])),_:2},1024),p(L,{class:"coupon-content"},{default:o((()=>[p(L,{class:"coupon-name"},{default:o((()=>[_(f(e.name),1)])),_:2},1024),p(L,{class:"coupon-middle"},{default:o((()=>[p(L,{class:"coupon-expire"},{default:o((()=>[e.expire_type==v.CouponTypeEnum.FULL_DISCOUNT.value?(c(),l(U,{key:0},{default:o((()=>[_("领取后"+f(e.expire_day)+"天内有效",1)])),_:2},1024)):y("",!0),e.expire_type==v.CouponTypeEnum.DISCOUNT.value?(c(),l(U,{key:1},{default:o((()=>[e.start_time===e.end_time?(c(),i(r,{key:0},[_(f(e.start_time)+" 当天有效",1)],64)):(c(),i(r,{key:1},[_(f(e.start_time)+"~"+f(e.end_time),1)],64))])),_:2},1024)):y("",!0)])),_:2},1024)])),_:2},1024),e.describe?(c(),l(L,{key:0,class:"coupon-expand",onClick:e=>g.handleDescribe(a)},{default:o((()=>[p(U,null,{default:o((()=>[_("使用说明")])),_:1}),p(U,{class:m(["coupon-expand-arrow iconfont icon-arrow-down",[e.expand?"expand":""]])},null,8,["class"])])),_:2},1032,["onClick"])):y("",!0)])),_:2},1024),p(L,{class:"coupon-right"},{default:o((()=>[e.state.value?y("",!0):(c(),l(L,{key:0,class:"state-text"},{default:o((()=>[p(U,null,{default:o((()=>[_(f(e.state.text),1)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1032,["class"]),p(L,{class:m([[e.expand?"expand":""],"coupon-expand-rules"])},{default:o((()=>[p(L,{class:"coupon-expand-rules-content"},{default:o((()=>[p(L,{class:"pre"},{default:o((()=>[_(f(e.describe),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["onInit","up","onUp"])])),_:1},8,["style"])}],["__scopeId","data-v-7bf077f8"]]);export{U as default};
